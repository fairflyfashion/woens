<!DOCTYPE html>
<html>
  <head>
    <title>Add Product</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <script>
      if (localStorage.getItem("adminLogin") !== "yes") {
        location.href = "admin-login.html";
      }
    </script>

    <!-- TOPBAR -->
    <div class="topbar">
      <h1>Add Product</h1>
    </div>

    <!-- NAV -->
    <div class="admin-nav">
      <button onclick="go('admin.html')">Home</button>
      <button onclick="go('dashboard.html')">Dashboard</button>
      <button onclick="go('orders.html')">Orders</button>
      <button onclick="go('add-product.html')">Add Product</button>
      <button onclick="go('manage-products.html')">Manage Products</button>
      <button class="danger" onclick="logout()">Logout</button>
    </div>

    <!-- FORM -->
    <div class="products">
      <div class="product-box">
        <h3>Add New Product</h3>

        <label>Product Name</label>
        <input id="name" placeholder="Product name" />

        <label>Selling Price</label>
        <input id="price" type="number" placeholder="Selling price" />

        <label>Purchase Price</label>
        <input id="purchase" type="number" placeholder="Purchase cost" />

        <label>Stock Quantity</label>
        <input id="stock" type="number" placeholder="Stock" />

        <label>Category</label>
        <select id="category">
          <option value="">Select category</option>
          <option value="men">Men</option>
          <option value="women">Women</option>
          <option value="kids">Kids</option>
        </select>

        <label>Image URL</label>
        <input id="img" placeholder="Image URL" />

        <button onclick="addProduct()">Add Product</button>
      </div>
    </div>

    <script>
      function addProduct() {
        let products = JSON.parse(localStorage.getItem("products")) || [];

        let nameVal = name.value.trim();
        let priceVal = Number(price.value);
        let purchaseVal = Number(purchase.value);
        let stockVal = Number(stock.value);
        let categoryVal = category.value;
        let imgVal = img.value.trim();

        /* ===== VALIDATION ===== */
        if (!nameVal || !categoryVal) {
          alert("Name and category are required");
          return;
        }
        if (priceVal <= 0 || purchaseVal < 0) {
          alert("Invalid price");
          return;
        }
        if (stockVal < 0) {
          alert("Invalid stock");
          return;
        }

        /* ===== DUPLICATE CHECK ===== */
        let exists = products.find(
          (p) =>
            p.name.toLowerCase() === nameVal.toLowerCase() &&
            p.category === categoryVal
        );
        if (exists) {
          alert("Product already exists in this category");
          return;
        }

        /* ===== ADD PRODUCT ===== */
        products.push({
          id: Date.now(),
          name: nameVal,
          price: priceVal,
          purchase: purchaseVal,
          stock: stockVal,
          category: categoryVal,
          img: imgVal || "images/no-image.png",
          createdAt: new Date().toISOString(),
        });

        localStorage.setItem("products", JSON.stringify(products));

        alert("Product added successfully âœ…");

        name.value =
          price.value =
          purchase.value =
          stock.value =
          img.value =
            "";
        category.value = "";
      }

      function go(p) {
        location.href = p;
      }
      function logout() {
        localStorage.removeItem("adminLogin");
        location.href = "admin-login.html";
      }
    </script>
  </body>
</html>
